


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ignite.engine &mdash; ignite master documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://pytorch.org/ignite/index.htmlengine.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="_static/css/ignite_theme.css" type="text/css" />
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ignite.handlers" href="handlers.html" />
    <link rel="prev" title="FAQ" href="faq.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://pytorch.org/ignite" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="concepts.html">Concepts</a>
          </li>

          <li>
            <a href="quickstart.html">Quickstart</a>
          </li>

          <li>
            <a href="examples.html">Examples</a>
          </li>

          <li>
            <a href="faq.html">FAQ</a>
          </li>

          <li>
            <a href="https://github.com/pytorch/ignite">Github</a>
          </li>

          <li>
            <a href="https://pytorch.org/ignite/master/about.html">About us</a>
          </li>

        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
                <div class="version">
                  master (0.4.0)
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>
<p class="caption"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">ignite.engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="handlers.html">ignite.handlers</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">ignite.metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="exceptions.html">ignite.exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">ignite.utils</a></li>
</ul>
<p class="caption"><span class="caption-text">Contrib Package Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contrib/engines.html">ignite.contrib.engines</a></li>
<li class="toctree-l1"><a class="reference internal" href="contrib/metrics.html">ignite.contrib.metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="contrib/handlers.html">ignite.contrib.handlers</a></li>
</ul>
<p class="caption"><span class="caption-text">Team</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">About us</a></li>
<li class="toctree-l1"><a class="reference internal" href="governance.html">PyTorch-Ignite governance</a></li>
</ul>

            
          
        </div>
      </div>

      <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: master
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Tags</dt>
            <dd><a href="../v0.1.0/engine.html">v0.1.0</a></dd>
            <dd><a href="../v0.1.1/engine.html">v0.1.1</a></dd>
            <dd><a href="../v0.1.2/engine.html">v0.1.2</a></dd>
            <dd><a href="../v0.2.0/engine.html">v0.2.0</a></dd>
            <dd><a href="../v0.2.1/engine.html">v0.2.1</a></dd>
            <dd><a href="../v0.3.0/engine.html">v0.3.0</a></dd>
        </dl>
        <dl>
            <dt>Branches</dt>
            <dd><a href="engine.html">master</a></dd>
        </dl>
    </div>
</div>

    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>ignite.engine</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="_sources/engine.rst.txt" rel="nofollow"><img src="_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <div class="section" id="ignite-engine">
<h1>ignite.engine<a class="headerlink" href="#ignite-engine" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="ignite.engine.engine.Engine">
<em class="property">class </em><code class="descclassname">ignite.engine.engine.</code><code class="descname">Engine</code><span class="sig-paren">(</span><em>process_function: Callable</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/engine/engine.html#Engine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.engine.Engine" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a given <cite>process_function</cite> over each batch of a dataset, emitting events as it goes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>process_function</strong> (<em>callable</em>) – A function receiving a handle to the engine and the current batch
in each iteration, and returns data to be stored in the engine’s state.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="ignite.engine.engine.Engine.state">
<code class="descname">state</code><a class="headerlink" href="#ignite.engine.engine.Engine.state" title="Permalink to this definition">¶</a></dt>
<dd><p>object that is used to pass internal and user-defined state between event handlers.
It is created with the engine and its attributes (e.g. <cite>state.iteration</cite>, <cite>state.epoch</cite> etc) are reset
on every <code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference internal" href="#ignite.engine.events.State" title="ignite.engine.events.State">State</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="ignite.engine.engine.Engine.last_event_name">
<code class="descname">last_event_name</code><a class="headerlink" href="#ignite.engine.engine.Engine.last_event_name" title="Permalink to this definition">¶</a></dt>
<dd><p>last event name triggered by the engine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference internal" href="#ignite.engine.events.Events" title="ignite.engine.events.Events">Events</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<p class="rubric">Examples</p>
<p>Create a basic trainer</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">update_model</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
    <span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span> <span class="o">=</span> <span class="n">batch</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">update_model</span><span class="p">)</span>

<span class="nd">@trainer</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">ITERATION_COMPLETED</span><span class="p">(</span><span class="n">every</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">log_training</span><span class="p">(</span><span class="n">engine</span><span class="p">):</span>
    <span class="n">batch_loss</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">output</span>
    <span class="n">lr</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">param_groups</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;lr&#39;</span><span class="p">]</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">epoch</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">max_epochs</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">iteration</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Epoch </span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2"> : </span><span class="si">{}</span><span class="s2"> - batch loss: </span><span class="si">{}</span><span class="s2">, lr: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">batch_loss</span><span class="p">,</span> <span class="n">lr</span><span class="p">))</span>

<span class="n">trainer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data_loader</span><span class="p">,</span> <span class="n">max_epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="o">&gt;</span> <span class="n">Epoch</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span> <span class="p">:</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">batch</span> <span class="n">loss</span><span class="p">:</span> <span class="mf">0.10874069479016124</span><span class="p">,</span> <span class="n">lr</span><span class="p">:</span> <span class="mf">0.01</span>
<span class="o">&gt;</span> <span class="o">...</span>
<span class="o">&gt;</span> <span class="n">Epoch</span> <span class="mi">2</span><span class="o">/</span><span class="mi">5</span> <span class="p">:</span> <span class="mi">1700</span> <span class="o">-</span> <span class="n">batch</span> <span class="n">loss</span><span class="p">:</span> <span class="mf">0.4217900575859437</span><span class="p">,</span> <span class="n">lr</span><span class="p">:</span> <span class="mf">0.01</span>
</pre></div>
</div>
<p>Create a basic evaluator to compute metrics</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ignite.metrics</span> <span class="kn">import</span> <span class="n">Accuracy</span>

<span class="k">def</span> <span class="nf">predict_on_batch</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">batch</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">prepare_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">non_blocking</span><span class="o">=</span><span class="n">non_blocking</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y</span>

<span class="n">evaluator</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">predict_on_batch</span><span class="p">)</span>
<span class="n">Accuracy</span><span class="p">()</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">evaluator</span><span class="p">,</span> <span class="s2">&quot;val_acc&quot;</span><span class="p">)</span>
<span class="n">evaluator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">val_dataloader</span><span class="p">)</span>
</pre></div>
</div>
<p>Compute image mean/std on training dataset</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ignite.metrics</span> <span class="kn">import</span> <span class="n">Average</span>

<span class="k">def</span> <span class="nf">compute_mean_std</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;image&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;image&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">mean2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="n">mean</span><span class="p">,</span> <span class="s2">&quot;mean^2&quot;</span><span class="p">:</span> <span class="n">mean2</span><span class="p">}</span>

<span class="n">compute_engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">compute_mean_std</span><span class="p">)</span>
<span class="n">img_mean</span> <span class="o">=</span> <span class="n">Average</span><span class="p">(</span><span class="n">output_transform</span><span class="o">=</span><span class="k">lambda</span> <span class="n">output</span><span class="p">:</span> <span class="n">output</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">])</span>
<span class="n">img_mean</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">compute_engine</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)</span>
<span class="n">img_mean2</span> <span class="o">=</span> <span class="n">Average</span><span class="p">(</span><span class="n">output_transform</span><span class="o">=</span><span class="k">lambda</span> <span class="n">output</span><span class="p">:</span> <span class="n">output</span><span class="p">[</span><span class="s1">&#39;mean^2&#39;</span><span class="p">])</span>
<span class="n">img_mean2</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">compute_engine</span><span class="p">,</span> <span class="s1">&#39;mean2&#39;</span><span class="p">)</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">compute_engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">train_loader</span><span class="p">)</span>
<span class="n">state</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;mean2&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">state</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
<p>Resume engine’s run from a state. User can load a <cite>state_dict</cite> and run engine starting from loaded state :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Restore from an epoch</span>
<span class="n">state_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;epoch&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;max_epochs&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;epoch_length&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_loader</span><span class="p">)}</span>
<span class="c1"># or an iteration</span>
<span class="c1"># state_dict = {&quot;iteration&quot;: 500, &quot;max_epochs&quot;: 100, &quot;epoch_length&quot;: len(data_loader)}</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">state_dict</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="ignite.engine.engine.Engine.add_event_handler">
<code class="descname">add_event_handler</code><span class="sig-paren">(</span><em>event_name: Any</em>, <em>handler: Callable</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.add_event_handler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.engine.Engine.add_event_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an event handler to be executed when the specified event is fired.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>event_name</strong> – An event or a list of events to attach the handler. Valid events are
from <code class="xref py py-class docutils literal notranslate"><span class="pre">Events</span></code> or any <cite>event_name</cite> added by
<code class="xref py py-meth docutils literal notranslate"><span class="pre">register_events()</span></code>.</li>
<li><strong>handler</strong> (<em>callable</em>) – the callable event handler that should be invoked. No restrictions on its signature.
The first argument can be optionally <cite>engine</cite>, the <code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code> object, handler is
bound to.</li>
<li><strong>*args</strong> – optional args to be passed to <cite>handler</cite>.</li>
<li><strong>**kwargs</strong> – optional keyword args to be passed to <cite>handler</cite>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note that other arguments can be passed to the handler in addition to the <cite>*args</cite> and  <cite>**kwargs</cite>
passed here, for example during <code class="xref py py-attr docutils literal notranslate"><span class="pre">EXCEPTION_RAISED</span></code>.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">RemovableEventHandle</span></code>, which can be used to remove the handler.</td>
</tr>
</tbody>
</table>
<p>Example usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">process_function</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">print_epoch</span><span class="p">(</span><span class="n">engine</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Epoch: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">epoch</span><span class="p">))</span>

<span class="n">engine</span><span class="o">.</span><span class="n">add_event_handler</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">EPOCH_COMPLETED</span><span class="p">,</span> <span class="n">print_epoch</span><span class="p">)</span>

<span class="n">events_list</span> <span class="o">=</span> <span class="n">Events</span><span class="o">.</span><span class="n">EPOCH_COMPLETED</span> <span class="o">|</span> <span class="n">Events</span><span class="o">.</span><span class="n">COMPLETED</span>

<span class="k">def</span> <span class="nf">execute_something</span><span class="p">():</span>
    <span class="c1"># do some thing not related to engine</span>
    <span class="k">pass</span>

<span class="n">engine</span><span class="o">.</span><span class="n">add_event_handler</span><span class="p">(</span><span class="n">events_list</span><span class="p">,</span> <span class="n">execute_something</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since v0.3.0, Events become more flexible and allow to pass an event filter to the Engine.
See <code class="xref py py-class docutils literal notranslate"><span class="pre">Events</span></code> for more details.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="ignite.engine.engine.Engine.fire_event">
<code class="descname">fire_event</code><span class="sig-paren">(</span><em>event_name: Any</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.fire_event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.engine.Engine.fire_event" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute all the handlers associated with given event.</p>
<p>This method executes all handlers associated with the event
<cite>event_name</cite>. This is the method used in <code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code> to call the
core events found in <code class="xref py py-class docutils literal notranslate"><span class="pre">Events</span></code>.</p>
<p>Custom events can be fired if they have been registered before with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">register_events()</span></code>. The engine <cite>state</cite> attribute should be used
to exchange “dynamic” data among <cite>process_function</cite> and handlers.</p>
<p>This method is called automatically for core events. If no custom
events are used in the engine, there is no need for the user to call
the method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>event_name</strong> – event for which the handlers should be executed. Valid
events are from <code class="xref py py-class docutils literal notranslate"><span class="pre">Events</span></code> or any <cite>event_name</cite> added by
<code class="xref py py-meth docutils literal notranslate"><span class="pre">register_events()</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ignite.engine.engine.Engine.has_event_handler">
<code class="descname">has_event_handler</code><span class="sig-paren">(</span><em>handler: Callable</em>, <em>event_name: Optional[Any] = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.has_event_handler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.engine.Engine.has_event_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the specified event has the specified handler.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>handler</strong> (<em>callable</em>) – the callable event handler.</li>
<li><strong>event_name</strong> – The event the handler attached to. Set this
to <code class="docutils literal notranslate"><span class="pre">None</span></code> to search all events.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ignite.engine.engine.Engine.load_state_dict">
<code class="descname">load_state_dict</code><span class="sig-paren">(</span><em>state_dict: collections.abc.Mapping</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.load_state_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.engine.Engine.load_state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Setups engine from <cite>state_dict</cite>.</p>
<p>State dictionary should contain keys: <cite>iteration</cite> or <cite>epoch</cite> and <cite>max_epochs</cite>, <cite>epoch_length</cite> and
<cite>seed</cite>. If <cite>engine.state_dict_user_keys</cite> contains keys, they should be also present in the state dictionary.
Iteration and epoch values are 0-based: the first iteration or epoch is zero.</p>
<p>This method does not remove any custom attributs added by user.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>state_dict</strong> (<em>Mapping</em>) – a dict with parameters</td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Restore from the 4rd epoch</span>
<span class="n">state_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;epoch&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;max_epochs&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;epoch_length&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_loader</span><span class="p">)}</span>
<span class="c1"># or 500th iteration</span>
<span class="c1"># state_dict = {&quot;iteration&quot;: 499, &quot;max_epochs&quot;: 100, &quot;epoch_length&quot;: len(data_loader)}</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">state_dict</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ignite.engine.engine.Engine.on">
<code class="descname">on</code><span class="sig-paren">(</span><em>event_name</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.on"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.engine.Engine.on" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator shortcut for add_event_handler.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>event_name</strong> – An event to attach the handler to. Valid events are from <code class="xref py py-class docutils literal notranslate"><span class="pre">Events</span></code> or
any <cite>event_name</cite> added by <code class="xref py py-meth docutils literal notranslate"><span class="pre">register_events()</span></code>.</li>
<li><strong>*args</strong> – optional args to be passed to <cite>handler</cite>.</li>
<li><strong>**kwargs</strong> – optional keyword args to be passed to <cite>handler</cite>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">process_function</span><span class="p">)</span>

<span class="nd">@engine</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">EPOCH_COMPLETED</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">print_epoch</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Epoch: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">epoch</span><span class="p">))</span>

<span class="nd">@engine</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">EPOCH_COMPLETED</span> <span class="o">|</span> <span class="n">Events</span><span class="o">.</span><span class="n">COMPLETED</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">execute_something</span><span class="p">():</span>
    <span class="c1"># do some thing not related to engine</span>
    <span class="k">pass</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ignite.engine.engine.Engine.register_events">
<code class="descname">register_events</code><span class="sig-paren">(</span><em>*event_names</em>, <em>event_to_attr: Optional[dict] = None</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.register_events"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.engine.Engine.register_events" title="Permalink to this definition">¶</a></dt>
<dd><p>Add events that can be fired.</p>
<p>Registering an event will let the user fire these events at any point.
This opens the door to make the <code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code> loop even more
configurable.</p>
<p>By default, the events from <code class="xref py py-class docutils literal notranslate"><span class="pre">Events</span></code> are registered.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>*event_names</strong> – An object (ideally a string or int) to define the
name of the event being supported.</li>
<li><strong>event_to_attr</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a><em>, </em><em>optional</em>) – A dictionary to map an event to a state attribute.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ignite.engine</span> <span class="kn">import</span> <span class="n">Engine</span><span class="p">,</span> <span class="n">EventEnum</span>

<span class="k">class</span> <span class="nc">CustomEvents</span><span class="p">(</span><span class="n">EventEnum</span><span class="p">):</span>
    <span class="n">FOO_EVENT</span> <span class="o">=</span> <span class="s2">&quot;foo_event&quot;</span>
    <span class="n">BAR_EVENT</span> <span class="o">=</span> <span class="s2">&quot;bar_event&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">process_function</span><span class="p">)</span>
<span class="n">engine</span><span class="o">.</span><span class="n">register_events</span><span class="p">(</span><span class="o">*</span><span class="n">CustomEvents</span><span class="p">)</span>
</pre></div>
</div>
<p>Example with State Attribute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">ignite.engine</span> <span class="kn">import</span> <span class="n">Engine</span><span class="p">,</span> <span class="n">EventEnum</span>

<span class="k">class</span> <span class="nc">TBPTT_Events</span><span class="p">(</span><span class="n">EventEnum</span><span class="p">):</span>
    <span class="n">TIME_ITERATION_STARTED</span> <span class="o">=</span> <span class="s2">&quot;time_iteration_started&quot;</span>
    <span class="n">TIME_ITERATION_COMPLETED</span> <span class="o">=</span> <span class="s2">&quot;time_iteration_completed&quot;</span>

<span class="n">TBPTT_event_to_attr</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">TBPTT_Events</span><span class="o">.</span><span class="n">TIME_ITERATION_STARTED</span><span class="p">:</span> <span class="s1">&#39;time_iteration&#39;</span><span class="p">,</span>
    <span class="n">TBPTT_Events</span><span class="o">.</span><span class="n">TIME_ITERATION_COMPLETED</span><span class="p">:</span> <span class="s1">&#39;time_iteration&#39;</span>
<span class="p">}</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">process_function</span><span class="p">)</span>
<span class="n">engine</span><span class="o">.</span><span class="n">register_events</span><span class="p">(</span><span class="o">*</span><span class="n">TBPTT_Events</span><span class="p">,</span> <span class="n">event_to_attr</span><span class="o">=</span><span class="n">TBPTT_event_to_attr</span><span class="p">)</span>
<span class="n">engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="c1"># engine.state contains an attribute time_iteration, which can be accessed using engine.state.time_iteration</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ignite.engine.engine.Engine.remove_event_handler">
<code class="descname">remove_event_handler</code><span class="sig-paren">(</span><em>handler: Callable</em>, <em>event_name: Any</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.remove_event_handler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.engine.Engine.remove_event_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove event handler <cite>handler</cite> from registered handlers of the engine</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>handler</strong> (<em>callable</em>) – the callable event handler that should be removed</li>
<li><strong>event_name</strong> – The event the handler attached to.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ignite.engine.engine.Engine.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>data: Iterable[T_co], max_epochs: Optional[int] = None, epoch_length: Optional[int] = None, seed: Optional[int] = None</em><span class="sig-paren">)</span> &#x2192; ignite.engine.events.State<a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.engine.Engine.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the <cite>process_function</cite> over the passed data.</p>
<p>Engine has a state and the following logic is applied in this function:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>At the first call, new state is defined by <cite>max_epochs</cite>, <cite>epoch_length</cite>, <cite>seed</cite> if provided. A timer for</dt>
<dd>total and per-epoch time is initialized when Events.STARTED is handled.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If state is already defined such that there are iterations to run until <cite>max_epochs</cite> and no input arguments</dt>
<dd>provided, state is kept and used in the function.</dd>
</dl>
</li>
<li>If state is defined and engine is “done” (no iterations to run until <cite>max_epochs</cite>), a new state is defined.</li>
<li>If state is defined, engine is NOT “done”, then input arguments if provided override defined state.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>Iterable</em>) – Collection of batches allowing repeated iteration (e.g., list or <cite>DataLoader</cite>).</li>
<li><strong>max_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Max epochs to run for (default: None).
If a new state should be created (first run or run again from ended engine), it’s default value is 1.
If run is resuming from a state, provided <cite>max_epochs</cite> will be taken into account and should be larger
than <cite>engine.state.max_epochs</cite>.</li>
<li><strong>epoch_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Number of iterations to count as one epoch. By default, it can be set as
<cite>len(data)</cite>. If <cite>data</cite> is an iterator and <cite>epoch_length</cite> is not set, then it will be automatically
determined as the iteration on which data iterator raises <cite>StopIteration</cite>.
This argument should not change if run is resuming from a state.</li>
<li><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Deprecated argument. Please, use <cite>torch.manual_seed</cite> or
<code class="xref py py-meth docutils literal notranslate"><span class="pre">manual_seed()</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">output state.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#ignite.engine.events.State" title="ignite.engine.events.State">State</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>User can dynamically preprocess input batch at <code class="xref py py-attr docutils literal notranslate"><span class="pre">ITERATION_STARTED</span></code> and store
output batch in <cite>engine.state.batch</cite>. Latter is passed as usually to <cite>process_function</cite> as argument:</p>
<div class="last highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">trainer</span> <span class="o">=</span> <span class="o">...</span>

<span class="nd">@trainer</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">ITERATION_STARTED</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">switch_batch</span><span class="p">(</span><span class="n">engine</span><span class="p">):</span>
    <span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">batch</span> <span class="o">=</span> <span class="n">preprocess_batch</span><span class="p">(</span><span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="method">
<dt id="ignite.engine.engine.Engine.set_data">
<code class="descname">set_data</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.set_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.engine.Engine.set_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to set data. After calling the method the next batch passed to <cite>processing_function</cite> is
from newly provided data. Please, note that epoch length is not modified.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<em>Iterable</em>) – Collection of batches allowing repeated iteration (e.g., list or <cite>DataLoader</cite>).</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Example usage:</dt>
<dd><p class="first">User can switch data provider during the training:</p>
<div class="last highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">data2</span> <span class="o">=</span> <span class="o">...</span>

<span class="n">switch_iteration</span> <span class="o">=</span> <span class="mi">5000</span>

<span class="k">def</span> <span class="nf">train_step</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
    <span class="c1"># when iteration &lt;= switch_iteration</span>
    <span class="c1"># batch is from data1</span>
    <span class="c1"># when iteration &gt; switch_iteration</span>
    <span class="c1"># batch is from data2</span>
    <span class="o">...</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">train_step</span><span class="p">)</span>

<span class="nd">@trainer</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">ITERATION_COMPLETED</span><span class="p">(</span><span class="n">once</span><span class="o">=</span><span class="n">switch_iteration</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">switch_dataloader</span><span class="p">():</span>
    <span class="n">trainer</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>

<span class="n">trainer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">max_epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ignite.engine.engine.Engine.state_dict">
<code class="descname">state_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; collections.OrderedDict<a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.state_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.engine.Engine.state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary containing engine’s state: “seed”, “epoch_length”, “max_epochs” and “iteration” and
other state values defined by <cite>engine.state_dict_user_keys</cite></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">engine</span><span class="o">.</span><span class="n">state_dict_user_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">)</span>
<span class="n">engine</span><span class="o">.</span><span class="n">state_dict_user_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;beta&quot;</span><span class="p">)</span>
<span class="o">...</span>

<span class="nd">@engine</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">STARTED</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">init_user_value</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>
     <span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span>
     <span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="nd">@engine</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">COMPLETED</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">save_engine</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>
    <span class="n">state_dict</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
    <span class="k">assert</span> <span class="s2">&quot;alpha&quot;</span> <span class="ow">in</span> <span class="n">state_dict</span> <span class="ow">and</span> <span class="s2">&quot;beta&quot;</span> <span class="ow">in</span> <span class="n">state_dict</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">state_dict</span><span class="p">,</span> <span class="s2">&quot;/tmp/engine.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a dictionary containing engine’s state</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">OrderedDict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ignite.engine.engine.Engine.terminate">
<code class="descname">terminate</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.terminate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.engine.Engine.terminate" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends terminate signal to the engine, so that it terminates completely the run after the current iteration.</p>
</dd></dl>

<dl class="method">
<dt id="ignite.engine.engine.Engine.terminate_epoch">
<code class="descname">terminate_epoch</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.terminate_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.engine.Engine.terminate_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends terminate signal to the engine, so that it terminates the current epoch after the current iteration.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-ignite.engine.engine"></span><dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">ignite.engine.engine.</code><code class="descname">Engine</code><span class="sig-paren">(</span><em>process_function: Callable</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/engine/engine.html#Engine"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Runs a given <cite>process_function</cite> over each batch of a dataset, emitting events as it goes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>process_function</strong> (<em>callable</em>) – A function receiving a handle to the engine and the current batch
in each iteration, and returns data to be stored in the engine’s state.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt>
<code class="descname">state</code></dt>
<dd><p>object that is used to pass internal and user-defined state between event handlers.
It is created with the engine and its attributes (e.g. <cite>state.iteration</cite>, <cite>state.epoch</cite> etc) are reset
on every <code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference internal" href="#ignite.engine.events.State" title="ignite.engine.events.State">State</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">last_event_name</code></dt>
<dd><p>last event name triggered by the engine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference internal" href="#ignite.engine.events.Events" title="ignite.engine.events.Events">Events</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<p class="rubric">Examples</p>
<p>Create a basic trainer</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">update_model</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
    <span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span> <span class="o">=</span> <span class="n">batch</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">update_model</span><span class="p">)</span>

<span class="nd">@trainer</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">ITERATION_COMPLETED</span><span class="p">(</span><span class="n">every</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">log_training</span><span class="p">(</span><span class="n">engine</span><span class="p">):</span>
    <span class="n">batch_loss</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">output</span>
    <span class="n">lr</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">param_groups</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;lr&#39;</span><span class="p">]</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">epoch</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">max_epochs</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">iteration</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Epoch </span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2"> : </span><span class="si">{}</span><span class="s2"> - batch loss: </span><span class="si">{}</span><span class="s2">, lr: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">batch_loss</span><span class="p">,</span> <span class="n">lr</span><span class="p">))</span>

<span class="n">trainer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data_loader</span><span class="p">,</span> <span class="n">max_epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="o">&gt;</span> <span class="n">Epoch</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span> <span class="p">:</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">batch</span> <span class="n">loss</span><span class="p">:</span> <span class="mf">0.10874069479016124</span><span class="p">,</span> <span class="n">lr</span><span class="p">:</span> <span class="mf">0.01</span>
<span class="o">&gt;</span> <span class="o">...</span>
<span class="o">&gt;</span> <span class="n">Epoch</span> <span class="mi">2</span><span class="o">/</span><span class="mi">5</span> <span class="p">:</span> <span class="mi">1700</span> <span class="o">-</span> <span class="n">batch</span> <span class="n">loss</span><span class="p">:</span> <span class="mf">0.4217900575859437</span><span class="p">,</span> <span class="n">lr</span><span class="p">:</span> <span class="mf">0.01</span>
</pre></div>
</div>
<p>Create a basic evaluator to compute metrics</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ignite.metrics</span> <span class="kn">import</span> <span class="n">Accuracy</span>

<span class="k">def</span> <span class="nf">predict_on_batch</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">batch</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">prepare_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">non_blocking</span><span class="o">=</span><span class="n">non_blocking</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">y</span>

<span class="n">evaluator</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">predict_on_batch</span><span class="p">)</span>
<span class="n">Accuracy</span><span class="p">()</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">evaluator</span><span class="p">,</span> <span class="s2">&quot;val_acc&quot;</span><span class="p">)</span>
<span class="n">evaluator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">val_dataloader</span><span class="p">)</span>
</pre></div>
</div>
<p>Compute image mean/std on training dataset</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ignite.metrics</span> <span class="kn">import</span> <span class="n">Average</span>

<span class="k">def</span> <span class="nf">compute_mean_std</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;image&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">&#39;image&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">mean2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="n">mean</span><span class="p">,</span> <span class="s2">&quot;mean^2&quot;</span><span class="p">:</span> <span class="n">mean2</span><span class="p">}</span>

<span class="n">compute_engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">compute_mean_std</span><span class="p">)</span>
<span class="n">img_mean</span> <span class="o">=</span> <span class="n">Average</span><span class="p">(</span><span class="n">output_transform</span><span class="o">=</span><span class="k">lambda</span> <span class="n">output</span><span class="p">:</span> <span class="n">output</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">])</span>
<span class="n">img_mean</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">compute_engine</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)</span>
<span class="n">img_mean2</span> <span class="o">=</span> <span class="n">Average</span><span class="p">(</span><span class="n">output_transform</span><span class="o">=</span><span class="k">lambda</span> <span class="n">output</span><span class="p">:</span> <span class="n">output</span><span class="p">[</span><span class="s1">&#39;mean^2&#39;</span><span class="p">])</span>
<span class="n">img_mean2</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">compute_engine</span><span class="p">,</span> <span class="s1">&#39;mean2&#39;</span><span class="p">)</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">compute_engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">train_loader</span><span class="p">)</span>
<span class="n">state</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;mean2&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">state</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
<p>Resume engine’s run from a state. User can load a <cite>state_dict</cite> and run engine starting from loaded state :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Restore from an epoch</span>
<span class="n">state_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;epoch&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;max_epochs&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;epoch_length&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_loader</span><span class="p">)}</span>
<span class="c1"># or an iteration</span>
<span class="c1"># state_dict = {&quot;iteration&quot;: 500, &quot;max_epochs&quot;: 100, &quot;epoch_length&quot;: len(data_loader)}</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">state_dict</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt>
<code class="descname">add_event_handler</code><span class="sig-paren">(</span><em>event_name: Any</em>, <em>handler: Callable</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.add_event_handler"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Add an event handler to be executed when the specified event is fired.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>event_name</strong> – An event or a list of events to attach the handler. Valid events are
from <code class="xref py py-class docutils literal notranslate"><span class="pre">Events</span></code> or any <cite>event_name</cite> added by
<code class="xref py py-meth docutils literal notranslate"><span class="pre">register_events()</span></code>.</li>
<li><strong>handler</strong> (<em>callable</em>) – the callable event handler that should be invoked. No restrictions on its signature.
The first argument can be optionally <cite>engine</cite>, the <code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code> object, handler is
bound to.</li>
<li><strong>*args</strong> – optional args to be passed to <cite>handler</cite>.</li>
<li><strong>**kwargs</strong> – optional keyword args to be passed to <cite>handler</cite>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note that other arguments can be passed to the handler in addition to the <cite>*args</cite> and  <cite>**kwargs</cite>
passed here, for example during <code class="xref py py-attr docutils literal notranslate"><span class="pre">EXCEPTION_RAISED</span></code>.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">RemovableEventHandle</span></code>, which can be used to remove the handler.</td>
</tr>
</tbody>
</table>
<p>Example usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">process_function</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">print_epoch</span><span class="p">(</span><span class="n">engine</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Epoch: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">epoch</span><span class="p">))</span>

<span class="n">engine</span><span class="o">.</span><span class="n">add_event_handler</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">EPOCH_COMPLETED</span><span class="p">,</span> <span class="n">print_epoch</span><span class="p">)</span>

<span class="n">events_list</span> <span class="o">=</span> <span class="n">Events</span><span class="o">.</span><span class="n">EPOCH_COMPLETED</span> <span class="o">|</span> <span class="n">Events</span><span class="o">.</span><span class="n">COMPLETED</span>

<span class="k">def</span> <span class="nf">execute_something</span><span class="p">():</span>
    <span class="c1"># do some thing not related to engine</span>
    <span class="k">pass</span>

<span class="n">engine</span><span class="o">.</span><span class="n">add_event_handler</span><span class="p">(</span><span class="n">events_list</span><span class="p">,</span> <span class="n">execute_something</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since v0.3.0, Events become more flexible and allow to pass an event filter to the Engine.
See <code class="xref py py-class docutils literal notranslate"><span class="pre">Events</span></code> for more details.</p>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">fire_event</code><span class="sig-paren">(</span><em>event_name: Any</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.fire_event"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Execute all the handlers associated with given event.</p>
<p>This method executes all handlers associated with the event
<cite>event_name</cite>. This is the method used in <code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code> to call the
core events found in <code class="xref py py-class docutils literal notranslate"><span class="pre">Events</span></code>.</p>
<p>Custom events can be fired if they have been registered before with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">register_events()</span></code>. The engine <cite>state</cite> attribute should be used
to exchange “dynamic” data among <cite>process_function</cite> and handlers.</p>
<p>This method is called automatically for core events. If no custom
events are used in the engine, there is no need for the user to call
the method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>event_name</strong> – event for which the handlers should be executed. Valid
events are from <code class="xref py py-class docutils literal notranslate"><span class="pre">Events</span></code> or any <cite>event_name</cite> added by
<code class="xref py py-meth docutils literal notranslate"><span class="pre">register_events()</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">has_event_handler</code><span class="sig-paren">(</span><em>handler: Callable</em>, <em>event_name: Optional[Any] = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.has_event_handler"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Check if the specified event has the specified handler.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>handler</strong> (<em>callable</em>) – the callable event handler.</li>
<li><strong>event_name</strong> – The event the handler attached to. Set this
to <code class="docutils literal notranslate"><span class="pre">None</span></code> to search all events.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">load_state_dict</code><span class="sig-paren">(</span><em>state_dict: collections.abc.Mapping</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.load_state_dict"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Setups engine from <cite>state_dict</cite>.</p>
<p>State dictionary should contain keys: <cite>iteration</cite> or <cite>epoch</cite> and <cite>max_epochs</cite>, <cite>epoch_length</cite> and
<cite>seed</cite>. If <cite>engine.state_dict_user_keys</cite> contains keys, they should be also present in the state dictionary.
Iteration and epoch values are 0-based: the first iteration or epoch is zero.</p>
<p>This method does not remove any custom attributs added by user.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>state_dict</strong> (<em>Mapping</em>) – a dict with parameters</td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Restore from the 4rd epoch</span>
<span class="n">state_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;epoch&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;max_epochs&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;epoch_length&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_loader</span><span class="p">)}</span>
<span class="c1"># or 500th iteration</span>
<span class="c1"># state_dict = {&quot;iteration&quot;: 499, &quot;max_epochs&quot;: 100, &quot;epoch_length&quot;: len(data_loader)}</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">state_dict</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">on</code><span class="sig-paren">(</span><em>event_name</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.on"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Decorator shortcut for add_event_handler.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>event_name</strong> – An event to attach the handler to. Valid events are from <code class="xref py py-class docutils literal notranslate"><span class="pre">Events</span></code> or
any <cite>event_name</cite> added by <code class="xref py py-meth docutils literal notranslate"><span class="pre">register_events()</span></code>.</li>
<li><strong>*args</strong> – optional args to be passed to <cite>handler</cite>.</li>
<li><strong>**kwargs</strong> – optional keyword args to be passed to <cite>handler</cite>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">process_function</span><span class="p">)</span>

<span class="nd">@engine</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">EPOCH_COMPLETED</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">print_epoch</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Epoch: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">epoch</span><span class="p">))</span>

<span class="nd">@engine</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">EPOCH_COMPLETED</span> <span class="o">|</span> <span class="n">Events</span><span class="o">.</span><span class="n">COMPLETED</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">execute_something</span><span class="p">():</span>
    <span class="c1"># do some thing not related to engine</span>
    <span class="k">pass</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">register_events</code><span class="sig-paren">(</span><em>*event_names</em>, <em>event_to_attr: Optional[dict] = None</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.register_events"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Add events that can be fired.</p>
<p>Registering an event will let the user fire these events at any point.
This opens the door to make the <code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code> loop even more
configurable.</p>
<p>By default, the events from <code class="xref py py-class docutils literal notranslate"><span class="pre">Events</span></code> are registered.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>*event_names</strong> – An object (ideally a string or int) to define the
name of the event being supported.</li>
<li><strong>event_to_attr</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a><em>, </em><em>optional</em>) – A dictionary to map an event to a state attribute.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ignite.engine</span> <span class="kn">import</span> <span class="n">Engine</span><span class="p">,</span> <span class="n">EventEnum</span>

<span class="k">class</span> <span class="nc">CustomEvents</span><span class="p">(</span><span class="n">EventEnum</span><span class="p">):</span>
    <span class="n">FOO_EVENT</span> <span class="o">=</span> <span class="s2">&quot;foo_event&quot;</span>
    <span class="n">BAR_EVENT</span> <span class="o">=</span> <span class="s2">&quot;bar_event&quot;</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">process_function</span><span class="p">)</span>
<span class="n">engine</span><span class="o">.</span><span class="n">register_events</span><span class="p">(</span><span class="o">*</span><span class="n">CustomEvents</span><span class="p">)</span>
</pre></div>
</div>
<p>Example with State Attribute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">ignite.engine</span> <span class="kn">import</span> <span class="n">Engine</span><span class="p">,</span> <span class="n">EventEnum</span>

<span class="k">class</span> <span class="nc">TBPTT_Events</span><span class="p">(</span><span class="n">EventEnum</span><span class="p">):</span>
    <span class="n">TIME_ITERATION_STARTED</span> <span class="o">=</span> <span class="s2">&quot;time_iteration_started&quot;</span>
    <span class="n">TIME_ITERATION_COMPLETED</span> <span class="o">=</span> <span class="s2">&quot;time_iteration_completed&quot;</span>

<span class="n">TBPTT_event_to_attr</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">TBPTT_Events</span><span class="o">.</span><span class="n">TIME_ITERATION_STARTED</span><span class="p">:</span> <span class="s1">&#39;time_iteration&#39;</span><span class="p">,</span>
    <span class="n">TBPTT_Events</span><span class="o">.</span><span class="n">TIME_ITERATION_COMPLETED</span><span class="p">:</span> <span class="s1">&#39;time_iteration&#39;</span>
<span class="p">}</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">process_function</span><span class="p">)</span>
<span class="n">engine</span><span class="o">.</span><span class="n">register_events</span><span class="p">(</span><span class="o">*</span><span class="n">TBPTT_Events</span><span class="p">,</span> <span class="n">event_to_attr</span><span class="o">=</span><span class="n">TBPTT_event_to_attr</span><span class="p">)</span>
<span class="n">engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="c1"># engine.state contains an attribute time_iteration, which can be accessed using engine.state.time_iteration</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">remove_event_handler</code><span class="sig-paren">(</span><em>handler: Callable</em>, <em>event_name: Any</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.remove_event_handler"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Remove event handler <cite>handler</cite> from registered handlers of the engine</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>handler</strong> (<em>callable</em>) – the callable event handler that should be removed</li>
<li><strong>event_name</strong> – The event the handler attached to.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">run</code><span class="sig-paren">(</span><em>data: Iterable[T_co], max_epochs: Optional[int] = None, epoch_length: Optional[int] = None, seed: Optional[int] = None</em><span class="sig-paren">)</span> &#x2192; ignite.engine.events.State<a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.run"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Runs the <cite>process_function</cite> over the passed data.</p>
<p>Engine has a state and the following logic is applied in this function:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>At the first call, new state is defined by <cite>max_epochs</cite>, <cite>epoch_length</cite>, <cite>seed</cite> if provided. A timer for</dt>
<dd>total and per-epoch time is initialized when Events.STARTED is handled.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If state is already defined such that there are iterations to run until <cite>max_epochs</cite> and no input arguments</dt>
<dd>provided, state is kept and used in the function.</dd>
</dl>
</li>
<li>If state is defined and engine is “done” (no iterations to run until <cite>max_epochs</cite>), a new state is defined.</li>
<li>If state is defined, engine is NOT “done”, then input arguments if provided override defined state.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>Iterable</em>) – Collection of batches allowing repeated iteration (e.g., list or <cite>DataLoader</cite>).</li>
<li><strong>max_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Max epochs to run for (default: None).
If a new state should be created (first run or run again from ended engine), it’s default value is 1.
If run is resuming from a state, provided <cite>max_epochs</cite> will be taken into account and should be larger
than <cite>engine.state.max_epochs</cite>.</li>
<li><strong>epoch_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Number of iterations to count as one epoch. By default, it can be set as
<cite>len(data)</cite>. If <cite>data</cite> is an iterator and <cite>epoch_length</cite> is not set, then it will be automatically
determined as the iteration on which data iterator raises <cite>StopIteration</cite>.
This argument should not change if run is resuming from a state.</li>
<li><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Deprecated argument. Please, use <cite>torch.manual_seed</cite> or
<code class="xref py py-meth docutils literal notranslate"><span class="pre">manual_seed()</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">output state.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#ignite.engine.events.State" title="ignite.engine.events.State">State</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>User can dynamically preprocess input batch at <code class="xref py py-attr docutils literal notranslate"><span class="pre">ITERATION_STARTED</span></code> and store
output batch in <cite>engine.state.batch</cite>. Latter is passed as usually to <cite>process_function</cite> as argument:</p>
<div class="last highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">trainer</span> <span class="o">=</span> <span class="o">...</span>

<span class="nd">@trainer</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">ITERATION_STARTED</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">switch_batch</span><span class="p">(</span><span class="n">engine</span><span class="p">):</span>
    <span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">batch</span> <span class="o">=</span> <span class="n">preprocess_batch</span><span class="p">(</span><span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_data</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.set_data"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Method to set data. After calling the method the next batch passed to <cite>processing_function</cite> is
from newly provided data. Please, note that epoch length is not modified.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<em>Iterable</em>) – Collection of batches allowing repeated iteration (e.g., list or <cite>DataLoader</cite>).</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Example usage:</dt>
<dd><p class="first">User can switch data provider during the training:</p>
<div class="last highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">data2</span> <span class="o">=</span> <span class="o">...</span>

<span class="n">switch_iteration</span> <span class="o">=</span> <span class="mi">5000</span>

<span class="k">def</span> <span class="nf">train_step</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
    <span class="c1"># when iteration &lt;= switch_iteration</span>
    <span class="c1"># batch is from data1</span>
    <span class="c1"># when iteration &gt; switch_iteration</span>
    <span class="c1"># batch is from data2</span>
    <span class="o">...</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="n">train_step</span><span class="p">)</span>

<span class="nd">@trainer</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">ITERATION_COMPLETED</span><span class="p">(</span><span class="n">once</span><span class="o">=</span><span class="n">switch_iteration</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">switch_dataloader</span><span class="p">():</span>
    <span class="n">trainer</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>

<span class="n">trainer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">max_epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">state_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; collections.OrderedDict<a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.state_dict"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns a dictionary containing engine’s state: “seed”, “epoch_length”, “max_epochs” and “iteration” and
other state values defined by <cite>engine.state_dict_user_keys</cite></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">engine</span><span class="o">.</span><span class="n">state_dict_user_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">)</span>
<span class="n">engine</span><span class="o">.</span><span class="n">state_dict_user_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;beta&quot;</span><span class="p">)</span>
<span class="o">...</span>

<span class="nd">@engine</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">STARTED</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">init_user_value</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>
     <span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span>
     <span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="nd">@engine</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">COMPLETED</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">save_engine</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>
    <span class="n">state_dict</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
    <span class="k">assert</span> <span class="s2">&quot;alpha&quot;</span> <span class="ow">in</span> <span class="n">state_dict</span> <span class="ow">and</span> <span class="s2">&quot;beta&quot;</span> <span class="ow">in</span> <span class="n">state_dict</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">state_dict</span><span class="p">,</span> <span class="s2">&quot;/tmp/engine.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a dictionary containing engine’s state</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">OrderedDict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">terminate</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.terminate"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Sends terminate signal to the engine, so that it terminates completely the run after the current iteration.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">terminate_epoch</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ignite/engine/engine.html#Engine.terminate_epoch"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Sends terminate signal to the engine, so that it terminates the current epoch after the current iteration.</p>
</dd></dl>

</dd></dl>

<div class="section" id="ignite-engine-events">
<h2>ignite.engine.events<a class="headerlink" href="#ignite-engine-events" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ignite.engine.events.Events">
<em class="property">class </em><code class="descclassname">ignite.engine.events.</code><code class="descname">Events</code><span class="sig-paren">(</span><em>value: str</em>, <em>event_filter: Optional[Callable] = None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/engine/events.html#Events"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.events.Events" title="Permalink to this definition">¶</a></dt>
<dd><p>Events that are fired by the <code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code> during execution. Built-in events:</p>
<ul class="simple">
<li>STARTED : triggered when engine’s run is started</li>
<li>EPOCH_STARTED : triggered when the epoch is started</li>
<li>GET_BATCH_STARTED : triggered before next batch is fetched</li>
<li>GET_BATCH_COMPLETED : triggered after the batch is fetched</li>
<li>ITERATION_STARTED : triggered when an iteration is started</li>
<li>ITERATION_COMPLETED : triggered when the iteration is ended</li>
<li>DATALOADER_STOP_ITERATION : engine’s specific event triggered when dataloader has no more data to provide</li>
<li>EXCEPTION_RAISED : triggered when an exception is encountered</li>
<li>TERMINATE_SINGLE_EPOCH : triggered when the run is about to end the current epoch,
after receiving <code class="xref py py-meth docutils literal notranslate"><span class="pre">terminate_epoch()</span></code> call.</li>
<li>TERMINATE : triggered when the run is about to end completely,
after receiving <code class="xref py py-meth docutils literal notranslate"><span class="pre">terminate()</span></code> call.</li>
<li>EPOCH_COMPLETED : triggered when the epoch is ended</li>
<li>COMPLETED : triggered when engine’s run is completed</li>
</ul>
<p>Since v0.3.0, Events become more flexible and allow to pass an event filter to the Engine:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">()</span>

<span class="c1"># a) custom event filter</span>
<span class="k">def</span> <span class="nf">custom_event_filter</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">event</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>

<span class="nd">@engine</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">ITERATION_STARTED</span><span class="p">(</span><span class="n">event_filter</span><span class="o">=</span><span class="n">custom_event_filter</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">call_on_special_event</span><span class="p">(</span><span class="n">engine</span><span class="p">):</span>
    <span class="c1"># do something on 1, 2, 5, 10, 50, 100 iterations</span>

<span class="c1"># b) &quot;every&quot; event filter</span>
<span class="nd">@engine</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">ITERATION_STARTED</span><span class="p">(</span><span class="n">every</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">call_every</span><span class="p">(</span><span class="n">engine</span><span class="p">):</span>
    <span class="c1"># do something every 10th iteration</span>

<span class="c1"># c) &quot;once&quot; event filter</span>
<span class="nd">@engine</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">ITERATION_STARTED</span><span class="p">(</span><span class="n">once</span><span class="o">=</span><span class="mi">50</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">call_once</span><span class="p">(</span><span class="n">engine</span><span class="p">):</span>
    <span class="c1"># do something on 50th iteration</span>
</pre></div>
</div>
<p>Event filter function <cite>event_filter</cite> accepts as input <cite>engine</cite> and <cite>event</cite> and should return True/False.
Argument <cite>event</cite> is the value of iteration or epoch, depending on which type of Events the function is passed.</p>
<p>Since v0.4.0, user can also combine events with <cite>|</cite>-operator:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">events</span> <span class="o">=</span> <span class="n">Events</span><span class="o">.</span><span class="n">STARTED</span> <span class="o">|</span> <span class="n">Events</span><span class="o">.</span><span class="n">COMPLETED</span> <span class="o">|</span> <span class="n">Events</span><span class="o">.</span><span class="n">ITERATION_STARTED</span><span class="p">(</span><span class="n">every</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">engine</span> <span class="o">=</span> <span class="o">...</span>

<span class="nd">@engine</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">events</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">call_on_events</span><span class="p">(</span><span class="n">engine</span><span class="p">):</span>
    <span class="c1"># do something</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="ignite.engine.events.State">
<em class="property">class </em><code class="descclassname">ignite.engine.events.</code><code class="descname">State</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/engine/events.html#State"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.events.State" title="Permalink to this definition">¶</a></dt>
<dd><p>An object that is used to pass internal and user-defined state between event handlers. By default, state
contains the following attributes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">state</span><span class="o">.</span><span class="n">iteration</span>         <span class="c1"># 1-based, the first iteration is 1</span>
<span class="n">state</span><span class="o">.</span><span class="n">epoch</span>             <span class="c1"># 1-based, the first epoch is 1</span>
<span class="n">state</span><span class="o">.</span><span class="n">seed</span>              <span class="c1"># seed to set at each epoch</span>
<span class="n">state</span><span class="o">.</span><span class="n">dataloader</span>        <span class="c1"># data passed to engine</span>
<span class="n">state</span><span class="o">.</span><span class="n">epoch_length</span>      <span class="c1"># optional length of an epoch</span>
<span class="n">state</span><span class="o">.</span><span class="n">max_epochs</span>        <span class="c1"># number of epochs to run</span>
<span class="n">state</span><span class="o">.</span><span class="n">batch</span>             <span class="c1"># batch passed to `process_function`</span>
<span class="n">state</span><span class="o">.</span><span class="n">output</span>            <span class="c1"># output of `process_function` after a single iteration</span>
<span class="n">state</span><span class="o">.</span><span class="n">metrics</span>           <span class="c1"># dictionary with defined metrics if any</span>
<span class="n">state</span><span class="o">.</span><span class="n">times</span>             <span class="c1"># dictionary with total and per-epoch times fetched on</span>
                        <span class="c1"># keys: Events.EPOCH_COMPLETED.name and Events.COMPLETED.name</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="ignite.engine.events.RemovableEventHandle">
<em class="property">class </em><code class="descclassname">ignite.engine.events.</code><code class="descname">RemovableEventHandle</code><span class="sig-paren">(</span><em>event_name: Union[ignite.engine.events.CallableEventWithFilter, enum.Enum, ignite.engine.events.EventsList], handler: Callable, engine</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/engine/events.html#RemovableEventHandle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.events.RemovableEventHandle" title="Permalink to this definition">¶</a></dt>
<dd><p>A weakref handle to remove a registered event.</p>
<p>A handle that may be used to remove a registered event handler via the
remove method, with-statement, or context manager protocol. Returned from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">add_event_handler()</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>event_name</strong> – Registered event name.</li>
<li><strong>handler</strong> – Registered event handler, stored as weakref.</li>
<li><strong>engine</strong> – Target engine, stored as weakref.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">print_epoch</span><span class="p">(</span><span class="n">engine</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Epoch: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">epoch</span><span class="p">))</span>

<span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">add_event_handler</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">EPOCH_COMPLETED</span><span class="p">,</span> <span class="n">print_epoch</span><span class="p">):</span>
    <span class="c1"># print_epoch handler registered for a single run</span>
    <span class="n">engine</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># print_epoch handler is now unregistered</span>
</pre></div>
</div>
<dl class="method">
<dt id="ignite.engine.events.RemovableEventHandle.remove">
<code class="descname">remove</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="_modules/ignite/engine/events.html#RemovableEventHandle.remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.events.RemovableEventHandle.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove handler from engine.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-ignite.engine.deterministic">
<span id="ignite-engine-deterministic"></span><h2>ignite.engine.deterministic<a class="headerlink" href="#module-ignite.engine.deterministic" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="ignite.engine.deterministic.update_dataloader">
<code class="descclassname">ignite.engine.deterministic.</code><code class="descname">update_dataloader</code><span class="sig-paren">(</span><em>dataloader: torch.utils.data.dataloader.DataLoader</em>, <em>new_batch_sampler: torch.utils.data.sampler.BatchSampler</em><span class="sig-paren">)</span> &#x2192; torch.utils.data.dataloader.DataLoader<a class="reference internal" href="_modules/ignite/engine/deterministic.html#update_dataloader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.deterministic.update_dataloader" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to replace current batch sampler of the dataloader by a new batch sampler. Function returns new
dataloader with new batch sampler.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dataloader</strong> (<em>torch.utils.data.DataLoader</em>) – input dataloader</li>
<li><strong>new_batch_sampler</strong> (<em>torch.utils.data.sampler.BatchSampler</em>) – new batch sampler to use</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">DataLoader</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ignite.engine.deterministic.keep_random_state">
<code class="descclassname">ignite.engine.deterministic.</code><code class="descname">keep_random_state</code><span class="sig-paren">(</span><em>func: Callable</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/engine/deterministic.html#keep_random_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.deterministic.keep_random_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper decorator to keep random state of torch, numpy and random intact
while executing a function. For more details on usage, please see
<a class="reference external" href="https://pytorch.org/ignite/concepts.html#dataflow-synchronization">“Concepts/Dataflow synchronization”</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>func</strong> (<em>callable</em>) – function to decorate</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="ignite.engine.deterministic.ReproducibleBatchSampler">
<em class="property">class </em><code class="descclassname">ignite.engine.deterministic.</code><code class="descname">ReproducibleBatchSampler</code><span class="sig-paren">(</span><em>batch_sampler: torch.utils.data.sampler.BatchSampler</em>, <em>start_iteration: Optional[int] = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/engine/deterministic.html#ReproducibleBatchSampler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.deterministic.ReproducibleBatchSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Reproducible batch sampler. This class internally iterates and stores indices of the input batch sampler.
This helps to start providing data batches from an iteration in a deterministic way.</p>
<p>Usage:</p>
<blockquote>
<div><p>Setup dataloader with <cite>ReproducibleBatchSampler</cite> and start providing data batches from an iteration:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ignite.engine.deterministic</span> <span class="kn">import</span> <span class="n">update_dataloader</span>

<span class="n">dataloader</span> <span class="o">=</span> <span class="n">update_dataloader</span><span class="p">(</span><span class="n">dataloader</span><span class="p">,</span> <span class="n">ReproducibleBatchSampler</span><span class="p">(</span><span class="n">dataloader</span><span class="o">.</span><span class="n">batch_sampler</span><span class="p">))</span>
<span class="c1"># rewind dataloader to a specific iteration:</span>
<span class="n">dataloader</span><span class="o">.</span><span class="n">batch_sampler</span><span class="o">.</span><span class="n">start_iteration</span> <span class="o">=</span> <span class="n">start_iteration</span>
</pre></div>
</div>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>batch_sampler</strong> (<em>torch.utils.data.sampler.BatchSampler</em>) – batch sampler same as used with
<cite>torch.utils.data.DataLoader</cite></li>
<li><strong>start_iteration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – optional start iteration</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="ignite.engine.deterministic.DeterministicEngine">
<em class="property">class </em><code class="descclassname">ignite.engine.deterministic.</code><code class="descname">DeterministicEngine</code><span class="sig-paren">(</span><em>process_function: Callable</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ignite/engine/deterministic.html#DeterministicEngine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.deterministic.DeterministicEngine" title="Permalink to this definition">¶</a></dt>
<dd><p>Deterministic engine derived from <code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code>.</p>
<p>“Deterministic” run is done by adding additional handlers to synchronize the dataflow and overriding some methods of
<code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_epochs</span><span class="p">):</span>
    <span class="n">set_seed</span><span class="p">(</span><span class="n">seed_offset</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">resume</span><span class="p">:</span>
        <span class="n">setup_saved_rng_states</span><span class="p">()</span>
    <span class="n">do_single_epoch_iterations</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span>
</pre></div>
</div>
<p>If input data provider is <cite>DataLoader</cite>, its batch sampler is replaced by
<a class="reference internal" href="#ignite.engine.deterministic.ReproducibleBatchSampler" title="ignite.engine.deterministic.ReproducibleBatchSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReproducibleBatchSampler</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_epochs</span><span class="p">):</span>
    <span class="n">set_seed</span><span class="p">(</span><span class="n">seed_offset</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span>
    <span class="n">setup_sampling</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">resume</span><span class="p">:</span>
        <span class="n">setup_saved_rng_states</span><span class="p">()</span>
    <span class="n">do_single_epoch_iterations</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span>
</pre></div>
</div>
<p>Internally, <cite>torch.backends.cudnn.deterministic = True</cite> and <cite>torch.backends.cudnn.benchmark = False</cite> are also
applied.</p>
<p>For more details about dataflow synchronization, please see
<a class="reference external" href="https://pytorch.org/ignite/concepts.html#dataflow-synchronization">“Concepts/Dataflow synchronization”</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This class can produce exactly the same dataflow when resuming the run from an epoch (or more precisely from
dataflow restart) and using torch <cite>DataLoader</cite> with <cite>num_workers &gt; 1</cite> as data provider.</p>
</div>
<dl class="method">
<dt id="ignite.engine.deterministic.DeterministicEngine.state_dict">
<code class="descname">state_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; collections.OrderedDict<a class="reference internal" href="_modules/ignite/engine/deterministic.html#DeterministicEngine.state_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ignite.engine.deterministic.DeterministicEngine.state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary containing engine’s state: “seed”, “epoch_length”, “max_epochs” and “iteration” and
other state values defined by <cite>engine.state_dict_user_keys</cite></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">engine</span><span class="o">.</span><span class="n">state_dict_user_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">)</span>
<span class="n">engine</span><span class="o">.</span><span class="n">state_dict_user_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;beta&quot;</span><span class="p">)</span>
<span class="o">...</span>

<span class="nd">@engine</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">STARTED</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">init_user_value</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>
     <span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span>
     <span class="n">engine</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="nd">@engine</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">Events</span><span class="o">.</span><span class="n">COMPLETED</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">save_engine</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>
    <span class="n">state_dict</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
    <span class="k">assert</span> <span class="s2">&quot;alpha&quot;</span> <span class="ow">in</span> <span class="n">state_dict</span> <span class="ow">and</span> <span class="s2">&quot;beta&quot;</span> <span class="ow">in</span> <span class="n">state_dict</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">state_dict</span><span class="p">,</span> <span class="s2">&quot;/tmp/engine.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a dictionary containing engine’s state</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">OrderedDict</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="handlers.html" class="btn btn-neutral float-right" title="ignite.handlers" accesskey="n" rel="next">Next <img src="_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="faq.html" class="btn btn-neutral" title="FAQ" accesskey="p" rel="prev"><img src="_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, PyTorch-Ignite Contributors.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">ignite.engine</a><ul>
<li><a class="reference internal" href="#ignite-engine-events">ignite.engine.events</a></li>
<li><a class="reference internal" href="#module-ignite.engine.deterministic">ignite.engine.deterministic</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  

     
       <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
         <script type="text/javascript" src="_static/jquery.js"></script>
         <script type="text/javascript" src="_static/underscore.js"></script>
         <script type="text/javascript" src="_static/doctools.js"></script>
         <script type="text/javascript" src="_static/language_data.js"></script>
         <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
     

  

  <script type="text/javascript" src="_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="_static/js/vendor/bootstrap.min.js"></script>
  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <!-- commented out for Ignite -->
  <!--

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-4 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer documentation for PyTorch</p>
          <a class="with-right-arrow" href="https://pytorch.org/ignite/index.html">View Docs</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Tutorials</h2>
          <p>Get in-depth tutorials for beginners and advanced developers</p>
          <a class="with-right-arrow" href="">View Tutorials</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <a class="with-right-arrow" href="">View Resources</a>
        </div>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://pytorch.org/ignite" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/ignite">PyTorch</a></li>
            <li><a href="">Get Started</a></li>
            <li><a href="">Features</a></li>
            <li><a href="">Ecosystem</a></li>
            <li><a href="">Blog</a></li>
            <li><a href="">Resources</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="">Support</a></li>
            <li><a href="">Tutorials</a></li>
            <li><a href="https://pytorch.org/ignite/index.html">Docs</a></li>
            <li><a href="" target="_blank">Discuss</a></li>
            <li><a href="https://github.com/pytorch/ignite/issues" target="_blank">Github Issues</a></li>
            <li><a href="" target="_blank">Slack</a></li>
            <li><a href="https://github.com/pytorch/ignite/blob/master/CONTRIBUTING.md" target="_blank">Contributing</a></li>
          </ul>
        </div>

        <div class="footer-links-col follow-us-col">
          <ul>
            <li class="list-title">Follow Us</li>
            <li>
              <div id="mc_embed_signup">
                <form
                  action="https://twitter.us14.list-manage.com/subscribe/post?u=75419c71fe0a935e53dfa4a3f&id=91d0dccd39"
                  method="post"
                  id="mc-embedded-subscribe-form"
                  name="mc-embedded-subscribe-form"
                  class="email-subscribe-form validate"
                  target="_blank"
                  novalidate>
                  <div id="mc_embed_signup_scroll" class="email-subscribe-form-fields-wrapper">
                    <div class="mc-field-group">
                      <label for="mce-EMAIL" style="display:none;">Email Address</label>
                      <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address">
                    </div>

                    <div id="mce-responses" class="clear">
                      <div class="response" id="mce-error-response" style="display:none"></div>
                      <div class="response" id="mce-success-response" style="display:none"></div>
                    </div>    <!~~ real people should not fill this in and expect good things - do not remove this or risk form bot signups ~~>

                    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_75419c71fe0a935e53dfa4a3f_91d0dccd39" tabindex="-1" value=""></div>

                    <div class="clear">
                      <input type="submit" value="" name="subscribe" id="mc-embedded-subscribe" class="button email-subscribe-button">
                    </div>
                  </div>
                </form>
              </div>

            </li>
          </ul>

          <div class="footer-social-icons">
            <a href="" target="_blank" class="facebook"></a>
            <a href="" target="_blank" class="twitter"></a>
          </div>
        </div>
      </div>
    </div>
  </footer>

  -->
  <!-- end of commented out for Ignite -->

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->
  <!--
  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorch.org/ignite" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="#">Get Started</a>
          </li>

          <li>
            <a href="#">Features</a>
          </li>

          <li>
            <a href="#">Ecosystem</a>
          </li>

          <li>
            <a href="">Blog</a>
          </li>

          <li>
            <a href="">Tutorials</a>
          </li>

          <li>
            <a href="https://pytorch.org/ignite/index.html">Docs</a>
          </li>

          <li>
            <a href="">Resources</a>
          </li>

          <li>
            <a href="https://github.com/pytorch/ignite">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  -->
  <!-- End Mobile Menu -->

  <script type="text/javascript" src="_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>